<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mvndicraft Damage Calculator</title>
    <style>
        :root {
            --bg-color: #1e1e24;
            --panel-bg: #2b2b36;
            --text-color: #e0e0e0;
            --accent: #d89b3c;
            --accent-hover: #b8822e;
            --input-bg: #18181d;
            --border: #3d3d4b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .calculator {
            background-color: var(--panel-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
            max-width: 400px;
            width: 100%;
            border: 1px solid var(--border);
        }

        h2 {
            margin-top: 0;
            color: var(--accent);
            text-align: center;
            font-size: 24px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .input-group {
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .input-group label {
            font-size: 14px;
            flex-basis: 60%;
        }

        .input-group input {
            flex-basis: 35%;
            background-color: var(--input-bg);
            border: 1px solid var(--border);
            color: white;
            padding: 8px;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }

        .input-group input:focus {
            border-color: var(--accent);
        }

        .results {
            margin-top: 25px;
            padding: 20px;
            background-color: var(--input-bg);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .result-row.final {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dashed var(--border);
            font-size: 20px;
            font-weight: bold;
            color: var(--accent);
        }

        .note {
            font-size: 12px;
            color: #888;
            text-align: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="calculator">
    <h2>Combat Calculator</h2>

    <!-- Weapon Stats -->
    <div class="input-group">
        <label title="The base damage of the weapon">Weapon Base Damage:</label>
        <input type="number" id="baseDmg" value="15.3" step="0.1" oninput="calculate()">
    </div>
    <div class="input-group">
        <label title="The weapon's strength scaling percentage">Strength Multiplier (%):</label>
        <input type="number" id="strMult" value="53.5" step="0.1" oninput="calculate()">
    </div>
    <div class="input-group">
        <label title="The weapon's dexterity scaling percentage">Dexterity Multiplier (%):</label>
        <input type="number" id="dexMult" value="53.5" step="0.1" oninput="calculate()">
    </div>

    <!-- Player Stats -->
    <div style="margin-top: 25px; margin-bottom: 15px; border-top: 1px solid var(--border); padding-top: 15px; color: #aaa; font-size: 13px; text-transform: uppercase; letter-spacing: 1px;">Player & Target</div>
    <div class="input-group">
        <label title="Your player's strength level">Strength Level (1-99):</label>
        <input type="number" id="strLvl" value="40" min="1" max="99" oninput="calculate()">
    </div>
    <div class="input-group">
        <label title="Your player's dexterity level">Dexterity Level (1-99):</label>
        <input type="number" id="dexLvl" value="40" min="1" max="99" oninput="calculate()">
    </div>
    <div class="input-group">
        <label title="The armor rating (Defense) of the target">Target Armor Rating:</label>
        <input type="number" id="armor" value="26.02" step="0.1" oninput="calculate()">
    </div>

    <!-- Results Box -->
    <div class="results">
        <div class="result-row">
            <span>Raw Attack:</span>
            <span id="outRaw">29.22</span>
        </div>
        <div class="result-row final">
            <span>Damage Dealt:</span>
            <span id="outFinal">13.06</span>
        </div>
    </div>

    <div class="note">Automatically calculates as you type.</div>
</div>

<script>
    // Recreates the stat multiplier tables from Mvndicraft dynamically
    function getLevelMultiplier(level) {
        if (level < 1) level = 1;
        if (level > 99) level = 99;
        
        let mult = 0;
        
        // Levels 1-10 (+0.005 per level)
        if (level >= 1) {
            let steps = Math.min(level, 10) - 1;
            mult += 0.005 + (steps * 0.005);
        }
        // Levels 11-20 (+0.035 per level)
        if (level > 10) {
            let steps = Math.min(level, 20) - 10;
            mult += (steps * 0.035);
        }
        // Levels 21-40 (+0.0225 per level)
        if (level > 20) {
            let steps = Math.min(level, 40) - 20;
            mult += (steps * 0.0225);
        }
        // Levels 41-99 (+0.0025 per level)
        if (level > 40) {
            let steps = Math.min(level, 99) - 40;
            mult += (steps * 0.0025);
        }
        
        return mult;
    }

    function calculate() {
        // Fetch inputs
        let baseDmg = parseFloat(document.getElementById('baseDmg').value) || 0;
        let strMult = (parseFloat(document.getElementById('strMult').value) || 0) / 100;
        let dexMult = (parseFloat(document.getElementById('dexMult').value) || 0) / 100;
        let strLvl = parseInt(document.getElementById('strLvl').value) || 1;
        let dexLvl = parseInt(document.getElementById('dexLvl').value) || 1;
        let def = parseFloat(document.getElementById('armor').value) || 0;

        // 1. Calculate the Raw Attack Damage
        let strBonus = baseDmg * strMult * getLevelMultiplier(strLvl);
        let dexBonus = baseDmg * dexMult * getLevelMultiplier(dexLvl);
        let atk = baseDmg + strBonus + dexBonus;

        // 2. Calculate Damage Through Armor (Dark Souls 3 Formula)
        let finalDmg = atk;
        if (def > 0) {
            let r = atk / def; // Ratio of Attack to Defense
            
            if (r <= 0.125) {
                finalDmg = atk * 0.1;
            } else if (r > 0.125 && r <= 1) {
                finalDmg = atk * ( (19.2 / 49) * Math.pow((r - 0.125), 2) + 0.1 );
            } else if (r > 1 && r <= 2.5) {
                finalDmg = atk * ( (-0.4 / 3) * Math.pow((r - 2.5), 2) + 0.7 );
            } else if (r > 2.5 && r < 8) {
                finalDmg = atk * ( (-0.8 / 121) * Math.pow((r - 8), 2) + 0.9 );
            } else {
                finalDmg = atk * 0.9;
            }
        }

        // Update UI
        document.getElementById('outRaw').innerText = atk.toFixed(2);
        document.getElementById('outFinal').innerText = finalDmg.toFixed(2);
    }

    // Run once on load to populate the defaults
    calculate();
</script>

</body>
</html>
